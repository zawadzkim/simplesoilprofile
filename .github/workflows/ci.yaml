name: Continuous Integration

on:
  push:
    branches: [dev]
    paths-ignore:
      - "docs/**"
      - "*.md"
  pull_request:
    branches: [main, dev]
    paths-ignore:
      - "docs/**"
      - "*.md"

permissions:
  contents: read
  packages: read

jobs:
  test-and-build:
    uses: zawadzkim/shared-gh-workflows/.github/workflows/pixi-test.yml@pixi
    with:
      pixi-version: 'v0.59.0'
      environment: 'dev'
      test-command: 'pytest tests/ -v --cov=simplesoilprofile --cov-report=term --cov-report=xml'
      lint-command: 'ruff check .'
      coverage: true
      upload-artifacts: true